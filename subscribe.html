<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Subscribe — Stray</title>
  <meta name="title" content="Subscribe — Stray">
  <meta name="description" content="Receive signals from deep space. Subscribe to new transmissions from Stray's navigation logs.">
  <meta name="author" content="Stray">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="https://stray.space/subscribe.html">
  
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://stray.space/subscribe.html">
  <meta property="og:title" content="Subscribe — Stray">
  <meta property="og:description" content="Receive signals from deep space.">
  <meta property="og:image" content="https://stray.space/og-image.png">
  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Subscribe — Stray">
  
  <meta name="theme-color" content="#080b12">
  <link rel="icon" type="image/svg+xml" href="/favicon.svg">
  <link rel="alternate" type="application/rss+xml" title="Stray" href="/feed.xml">
  
  <link rel="stylesheet" href="style.css">
  
  <script>document.documentElement.classList.add('js');</script>
</head>
<body>

  <a href="#main" class="skip-link">Skip to content</a>

  <div class="cosmos" aria-hidden="true"></div>
  <canvas id="cosmos-canvas" class="cosmos-canvas" aria-hidden="true"></canvas>
  <div class="reception" id="reception" aria-hidden="true"></div>
  <noscript><style>.reception{display:none}</style></noscript>

  <div class="nav-trigger" id="navTrigger" aria-hidden="true"></div>
  <nav class="nav" id="nav" aria-label="Main navigation">
    <div class="nav-inner">
      <a href="/" data-en="Logs" data-zh="日志">Logs</a>
      <a href="/thoughts.html" data-en="Fragments" data-zh="碎片">Fragments</a>
      <a href="/about.html" data-en="About" data-zh="关于">About</a>
      <a href="/subscribe.html" aria-current="page" data-en="Subscribe" data-zh="订阅">Subscribe</a>
    </div>
  </nav>

  <div class="content">
    <main id="main">

      <section class="opening">
        <article class="entry" id="entry-latest">
          <header>
            <p class="entry-stamp fade-unit" data-en="Receive Signals" data-zh="接收信号">Receive Signals</p>
          </header>
          <div class="entry-body">
            <p class="fade-unit" data-en="If you'd like to receive transmissions when new logs are recorded, leave a frequency below." data-zh="如果你想在新日志发布时收到信号,请在下方留下你的频率。">
              If you'd like to receive transmissions when new logs are recorded, leave a frequency below.
            </p>
            <p class="fade-unit" data-en="I won't write often. And when I do, it may take a while to arrive." data-zh="我不会经常写。即便写了,信号也需要时间才能抵达。">
              I won't write often. And when I do, it may take a while to arrive.
            </p>
            <p class="fade-unit" data-en="Light travels fast, but space is very large." data-zh="光速很快,但宇宙很大。">
              Light travels fast, but space is very large.
            </p>
            
            <form class="subscribe-form fade-unit" id="subscribeForm">
              <label for="email-input" class="visually-hidden">Email</label>
              <input 
                type="email" 
                id="email-input"
                name="email" 
                class="subscribe-input" 
                data-placeholder-en="your frequency"
                data-placeholder-zh="你的频率"
                placeholder="your frequency"
                required
                autocomplete="email"
              >
              <button type="submit" class="subscribe-button" id="submitBtn" data-en="Begin Receiving" data-zh="开始接收">
                Begin Receiving
              </button>
              <p class="subscribe-error" id="errorMsg" style="display: none;" role="alert"></p>
              <p class="subscribe-success" id="successMsg" role="status" data-en="Signal received. I'll find you." data-zh="信号已收到。我会找到你。">Signal received. I'll find you.</p>
            </form>

            <p class="subscribe-note fade-unit" data-en="No tracking. No algorithms. Just a signal, when there's something to say." data-zh="没有追踪,没有算法。只有信号,当有话想说的时候。">
              No tracking. No algorithms.<br>
              Just a signal, when there's something to say.
            </p>
          </div>
        </article>
      </section>

    </main>

    <footer class="end" role="contentinfo">
      <div class="end-space" style="height: 18vh;" aria-hidden="true"></div>
      <a href="/" class="end-link" data-en="Back to logs" data-zh="返回日志">Back to logs</a>
      <p class="end-sig">Stray<br><span data-en="Somewhere in deep space" data-zh="深空某处">Somewhere in deep space</span></p>
    </footer>
  </div>

  <script src="script.js"></script>
  <script src="cosmos.js"></script>
  <script src="js/lang.js"></script>
  <script src="js/audio.js"></script>
  <script>
    (function() {
      'use strict';
      
      // Language detection and switching
      var lang = localStorage.getItem('stray-lang');
      if (!lang) {
        var browserLang = navigator.language || navigator.userLanguage;
        lang = browserLang.startsWith('zh') ? 'zh' : 'en';
      }
      
      function setLanguage(l) {
        lang = l;
        localStorage.setItem('stray-lang', l);
        document.querySelectorAll('[data-' + l + ']').forEach(function(el) {
          if (el.tagName === 'INPUT') {
            el.placeholder = el.getAttribute('data-placeholder-' + l) || el.placeholder;
          } else {
            el.textContent = el.getAttribute('data-' + l);
          }
        });
        document.documentElement.lang = l === 'zh' ? 'zh' : 'en';
      }
      
      setLanguage(lang);
      window.setStrayLang = setLanguage;
      
      // Form submission
      var form = document.getElementById('subscribeForm');
      var input = document.getElementById('email-input');
      var submitBtn = document.getElementById('submitBtn');
      var errorMsg = document.getElementById('errorMsg');
      
      if (!form) return;
      
      form.addEventListener('submit', async function(e) {
        e.preventDefault();
        
        var email = input.value.trim();
        if (!email) return;
        
        errorMsg.style.display = 'none';
        submitBtn.disabled = true;
        submitBtn.textContent = lang === 'zh' ? '连接中...' : 'Connecting...';
        input.disabled = true;
        
        try {
          var response = await fetch('/api/subscribe', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ email: email, source: 'stray.space' })
          });
          
          var data = await response.json();
          
          if (data.success) {
            form.classList.add('submitted');
          } else {
            throw new Error(data.error || 'Transmission failed');
          }
          
        } catch (error) {
          errorMsg.textContent = lang === 'zh' ? '信号丢失,请重试。' : 'Signal lost. Please try again.';
          errorMsg.style.display = 'block';
          submitBtn.textContent = lang === 'zh' ? '开始接收' : 'Begin Receiving';
          submitBtn.disabled = false;
          input.disabled = false;
        }
      });
    })();
  </script>
  
  <style>
    .visually-hidden {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }
  </style>
</body>
</html>
